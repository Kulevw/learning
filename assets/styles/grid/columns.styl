@import "params.styl"
@import "grid-mixins.styl"

make_gutter_cols(bp)
  gutter = value_of_adaptive_values(cols_gutters, bp)

  $col-{bp}-{gutter}
    padding-left gutter
    padding-right gutter

  breakpoints_keys = get_breakpoints_keys()
  num_gutter = index_of(breakpoints_keys, bp)

  if index_of(keys(cols_gutters), bp) != -1
    for local_bp in breakpoints_keys
      local_bp_num = index_of(breakpoints_keys, local_bp)
      if local_bp_num <= num_gutter
        .col{local_bp}, .col{local_bp}-auto
          @extend $col-{bp}-{gutter}

        for span in (1 .. columns_count)
          .col{local_bp}-{span}
            @extend $col-{bp}-{gutter}
  else
    .col{bp}, .col{bp}-auto
      @extend $col-{bp}-{gutter}

    for span in (1 .. columns_count)
      .col{bp}-{span}
        @extend $col-{bp}-{gutter}

columns(bp = '')
  make_gutter_cols(bp)

  .col{bp}
    flex-basis 0%
    flex-grow 1
    max-width 100%
    min-width 0.01px

  .col{bp}-auto
    flex 0 0 auto
    width auto
    max-width 100%

  for span in (1 .. columns_count)
    .col{bp}-{span}
      percent = (span / columns_count) * 100%
      flex 0 0 percent
      max-width percent
      width 100%

